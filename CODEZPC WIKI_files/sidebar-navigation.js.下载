(function(){"use strict";let hamburger,sidebar,content,body;let touchStartX=0,touchEndX=0;let touchStartY=0,touchCurrentY=0;let isDragging=false;let dragProgress=0;let startTime=0;const CONFIG={swipeThreshold:50,edgeThreshold:50,verticalThreshold:30,dragFollowThreshold:10,maxSwipeTime:300,snapThreshold:.4,autoScrollOffset:150};document.addEventListener("DOMContentLoaded",function(){hamburger=document.querySelector(".hamburger");sidebar=document.querySelector(".sidebar");content=document.querySelector(".content");body=document.body;initHamburgerMenu();initClickOutside();initSidebarLinks();initTouchGestures();scrollActiveIntoView()});function toggleSidebar(){if(!hamburger||!sidebar||!body||!content)return;hamburger.classList.toggle("active");sidebar.classList.toggle("active");body.classList.toggle("sidebar-active");content.classList.toggle("sidebar-active")}function openSidebar(){if(!hamburger||!sidebar||!body||!content)return;hamburger.classList.add("active");sidebar.classList.add("active");body.classList.add("sidebar-active");content.classList.add("sidebar-active");resetSidebarTransforms()}function closeSidebar(){if(!hamburger||!sidebar||!body||!content)return;hamburger.classList.remove("active");sidebar.classList.remove("active");body.classList.remove("sidebar-active");content.classList.remove("sidebar-active");resetSidebarTransforms()}function initHamburgerMenu(){if(!hamburger)return;hamburger.addEventListener("click",function(e){e.stopPropagation();toggleSidebar()})}function initClickOutside(){document.addEventListener("click",function(e){if(sidebar&&sidebar.classList.contains("active")&&!sidebar.contains(e.target)&&!hamburger.contains(e.target)){closeSidebar()}})}function initSidebarLinks(){if(!sidebar)return;sidebar.querySelectorAll("a").forEach(link=>{link.addEventListener("click",function(){if(window.innerWidth<=768){closeSidebar()}})})}function scrollActiveIntoView(){const navItems=document.querySelector(".nav-items");if(!navItems)return;const activeItems=navItems.querySelectorAll(".nav-item.active");if(!activeItems.length)return;let deepestItem=activeItems[0];let maxDepth=getElementDepth(deepestItem,navItems);for(let i=1;i<activeItems.length;i++){const depth=getElementDepth(activeItems[i],navItems);if(depth>maxDepth){maxDepth=depth;deepestItem=activeItems[i]}}let offset=CONFIG.autoScrollOffset;const logo=document.querySelector(".sidebar img, .sidebar svg");if(logo){offset+=logo.offsetHeight}navItems.scrollTop=Math.max(0,deepestItem.offsetTop-offset)}function getElementDepth(element,container){let depth=0;let parent=element.parentElement;while(parent&&parent!==container){depth++;parent=parent.parentElement}return depth}function initTouchGestures(){document.addEventListener("touchstart",handleTouchStart,{passive:false});document.addEventListener("touchmove",handleTouchMove,{passive:false});document.addEventListener("touchend",handleTouchEnd,{passive:true});document.addEventListener("touchcancel",handleTouchCancel,{passive:true})}function handleTouchStart(e){if(e.touches.length!==1)return;const touch=e.touches[0];touchStartX=touch.clientX;touchStartY=touch.clientY;startTime=Date.now();isDragging=false;dragProgress=0;const isLeftEdgeTouch=touchStartX<=CONFIG.edgeThreshold;const sidebarClosed=!sidebar.classList.contains("active");if(sidebarClosed&&!isLeftEdgeTouch){return}}function handleTouchMove(e){if(e.touches.length!==1)return;const touch=e.touches[0];const currentX=touch.clientX;const currentY=touch.clientY;const deltaX=currentX-touchStartX;const deltaY=Math.abs(currentY-touchStartY);if(deltaY>CONFIG.verticalThreshold){return}if(Math.abs(deltaX)>CONFIG.dragFollowThreshold){const isValidLeftEdgeSwipe=touchStartX<=CONFIG.edgeThreshold&&deltaX>0&&!sidebar.classList.contains("active");const isValidCloseSwipe=sidebar.classList.contains("active")&&deltaX<0;if(isValidLeftEdgeSwipe||isValidCloseSwipe){isDragging=true;e.preventDefault();updateSidebarPosition(deltaX)}}}function handleTouchEnd(e){if(e.changedTouches.length!==1)return;touchEndX=e.changedTouches[0].clientX;if(isDragging){const swipeDistance=touchEndX-touchStartX;const swipeTime=Date.now()-startTime;const velocity=Math.abs(swipeDistance)/swipeTime;const sidebarOpen=sidebar.classList.contains("active");if(velocity>.8&&swipeTime<CONFIG.maxSwipeTime){if(swipeDistance>0&&!sidebarOpen){openSidebar()}else if(swipeDistance<0&&sidebarOpen){closeSidebar()}else{handleDragEnd()}}else{handleDragEnd()}}else{handleSwipeGesture()}isDragging=false;dragProgress=0;resetSidebarTransforms()}function handleTouchCancel(){isDragging=false;dragProgress=0;resetSidebarTransforms()}function updateSidebarPosition(deltaX){if(!sidebar)return;const isOpen=sidebar.classList.contains("active");const sidebarWidth=sidebar.offsetWidth;let progress;if(!isOpen){progress=Math.max(0,Math.min(1,deltaX/sidebarWidth))}else{progress=Math.max(0,Math.min(1,1+deltaX/sidebarWidth))}dragProgress=progress;const translateX=isOpen?(progress-1)*sidebarWidth:(progress-1)*sidebarWidth;sidebar.style.transform=`translateX(${translateX}px)`;if(progress>.3){sidebar.style.boxShadow="2px 0 8px rgba(0, 0, 0, 0.2)"}else{sidebar.style.boxShadow=""}}function resetSidebarTransforms(){if(!sidebar)return;sidebar.style.transform="";sidebar.style.boxShadow=""}function handleDragEnd(){const isOpen=sidebar.classList.contains("active");if(isOpen){if(dragProgress<1-CONFIG.snapThreshold){closeSidebar()}else{openSidebar()}}else{if(dragProgress>=CONFIG.snapThreshold){openSidebar()}else{resetSidebarTransforms()}}}function handleSwipeGesture(){if(!sidebar)return;const swipeDistance=touchEndX-touchStartX;const swipeTime=Date.now()-startTime;const verticalDistance=Math.abs(touchCurrentY-touchStartY);if(verticalDistance>CONFIG.verticalThreshold)return;if(swipeTime>CONFIG.maxSwipeTime)return;const sidebarOpen=sidebar.classList.contains("active");if(swipeDistance>CONFIG.swipeThreshold&&touchStartX<=CONFIG.edgeThreshold&&!sidebarOpen){openSidebar()}else if(swipeDistance<-CONFIG.swipeThreshold&&sidebarOpen){closeSidebar()}const velocity=Math.abs(swipeDistance)/swipeTime;if(velocity>.8){if(swipeDistance>30&&touchStartX<=CONFIG.edgeThreshold&&!sidebarOpen){openSidebar()}else if(swipeDistance<-30&&sidebarOpen){closeSidebar()}}}function findScrollableParent(element){if(!element||element===document.body)return null;const style=window.getComputedStyle(element);const isScrollable=style.overflowX==="auto"||style.overflowX==="scroll"||style.overflowY==="auto"||style.overflowY==="scroll";if(isScrollable&&(element.scrollWidth>element.clientWidth||element.scrollHeight>element.clientHeight)){return element}if(element.tagName==="PRE"||element.tagName==="CODE"||element.classList.contains("CodeMirror")||element.classList.contains("breadcrumbs-path")){return element}return findScrollableParent(element.parentElement)}async function refreshSidebar(){if(!sidebar)return;try{const response=await fetch(window.location.pathname);const text=await response.text();const parser=new DOMParser;const doc=parser.parseFromString(text,"text/html");const newSidebar=doc.querySelector(".nav-items");if(newSidebar){const navItems=sidebar.querySelector(".nav-items");if(navItems){navItems.innerHTML=newSidebar.innerHTML;initSidebarLinks()}}}catch(error){console.error("Error refreshing sidebar:",error)}}window.SidebarNavigation={toggleSidebar:toggleSidebar,openSidebar:openSidebar,closeSidebar:closeSidebar,refreshSidebar:refreshSidebar}})();